# Configure local settings

[< README]

## .gitignore

### Generated files

While the [advice from build_runner] is that "it is generally best to not submit generated files to source control", there are [many opinions] on the topic and first party examples such as [video_player] where generated code is commited.

If you choose no to commit generated files, add the following to your `.gitignore`:

> *If there are already generated files commited, make sure to delete them & make a separate commit first*

```.gitignore
# build_runner generated files
**/*.g.dart
**/*.freezed.dart
**/*.mocks.dart
```

### Config files

The FlutterFire config file cotains an "API Key" that is apparently fine to be public (citation) but best practice is (arguably) to not commit...

A similar argument can be made for your RedFire config file.  
> *Currently the Firebase config file is autogenerated while the RedFire config file is not but this will change in the near future.*

If you don't want to commit the config files, add the following to your `.gitignore`:

```.gitignore
# Firebase config file
lib/firebase_options.dart
lib/redfire_options.dart
```

## lints

Optionally: use the redfire lints by updating your `analysis_options.yaml` to

```yaml
include: package:redfire/lints.yaml
```

You can then (if desired) remove the import of `flutter_lints` in your `pubspec.yaml` because `redfire/lints.yaml` imports it.

## snippets

Using code snippets will save you *lots* of time & hassle

*VS Code*:

- copy the `.vscode/project.code-snippets` file from the redfire package into your project
- optionally remove the redfire specific snippets, ie. the ones that end in `_redfire`

### Configure static analysis

Add to `analysis_options.yaml`:

```yaml
analyzer:
  exclude: 
    - build/**
    - lib/*.g.dart
    - lib/*.freezed.dart
    - lib/**/*.g.dart
    - lib/**/*.freezed.dart
    - test/**/*.mocks.dart
  strong-mode:
    implicit-casts: false
    implicit-dynamic: false
```

You may not want all of the above, see [Customizing static analysis](https://dart.dev/guides/language/analysis-options) for more info.

### (optionally) Hide generated & irrelevant files

#### VS Code

Add `settings.json` with the following to the `.vscode` folder:

```json
{
  "files.exclude": {
    "**/*.g.dart": true,
    "**/*.freezed.dart": true,
    // "build": true,
    // ".flutter-plugins": true,
    // ".flutter-plugins-dependencies": true,
    // ".metadata": true,
    // ".packages": true,
    // "CHANGELOG.md": true,
    // "LICENSE": true,
    // "lib/generated_plugin_registrant.dart": true,
  }
}
```

### (possibly) Add a `build.yaml` with `explicit_to_json: true`

If you are using `fast_immutable_collections` and get errors serializing classes with list members, create a `build.yaml` file and add the following (the defaults + explicit_to_json: true)

- For more info see: <https://pub.dev/packages/json_serializable#build-configuration>

```yaml
targets:
  $default:
    builders:
      json_serializable:
        options:
          # Options configure how source code is generated for every
          # `@JsonSerializable`-annotated class in the package.
          #
          # The default value for each is listed, but with 
          # explicit_to_json: true so FIC collections will serialize
          any_map: false
          checked: false
          create_factory: true
          create_to_json: true
          disallow_unrecognized_keys: false
          explicit_to_json: true
          field_rename: none
          generic_argument_factories: false
          ignore_unannotated: false
          include_if_null: true
```

This is needed because `freezed` generates the toJson. In the [FIC example](https://github.com/marcglasberg/fast_immutable_collections#11-json-support) they have an explicit toJson added manually.

We can look into better ways around this if it is problematic.

### (possibly) Add a launch configuration for web that uses port 5000

```json
{
  "name": "web",
  "request": "launch",
  "type": "dart",
  "deviceId": "chrome",
  "args": ["--web-hostname", "localhost", "--web-port", "5000"]
},
```

[< README]: ../../../README.md
[advice from build_runner]: https://pub.dev/packages/build_runner#source-control
[many opinions]: https://stackoverflow.com/questions/56110386/should-i-commit-generated-code-in-flutter-dart-to-vcs
[video_player]: https://github.com/flutter/plugins/blob/master/packages/video_player/video_player_platform_interface/lib/messages.dart
